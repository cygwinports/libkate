diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4~' -x aclocal.m4t -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x '*config.h.in' -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x 'lt~obsolete.m4' -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/libkate-0.1.5/Makefile src/libkate-0.1.5/Makefile
--- origsrc/libkate-0.1.5/Makefile	2008-07-07 14:36:35.000000000 -0500
+++ src/libkate-0.1.5/Makefile	2008-07-17 21:53:25.609375000 -0500
@@ -60,16 +60,20 @@
 
 OBJS_STATIC=$(foreach module, $(MODULES),$(OBJDIR)/static/$(module).o)
 OBJS_SHARED=$(foreach module, $(MODULES),$(OBJDIR)/shared/$(module).o)
+OBJS_LIBTOOL=$(foreach module, $(MODULES),$(OBJDIR)/$(module).lo)
 
 LIBOGGKATE_OBJS_STATIC=$(OBJDIR)/static/kate_ogg.o
 LIBOGGKATE_OBJS_SHARED=$(OBJDIR)/shared/kate_ogg.o
+LIBOGGKATE_OBJS_LIBTOOL=$(OBJDIR)/kate_ogg.lo
 
 STATICLIBS=$(LIBDIR)/liboggkate.a $(LIBDIR)/libkate.a
 SHAREDLIBS=$(LIBDIR)/liboggkate.$(VERSION).so $(LIBDIR)/libkate.$(VERSION).so
+LIBTOOLLIBS=$(LIBDIR)/liboggkate.la $(LIBDIR)/libkate.la
 
 all: staticlib sharedlib tools #doc
 staticlib: $(STATICLIBS)
 sharedlib: $(SHAREDLIBS)
+libtoollib: $(LIBTOOLLIBS)
 
 LEX=$(shell which flex 2> /dev/null)
 YACC=$(shell which bison 2> /dev/null)
@@ -107,6 +111,11 @@
 	@mkdir -p $(dir $@)
 	@$(CC) $(CFLAGS_SHARED) $(CWARNFLAGS_FULL) -o $@ -c $<
 
+$(OBJDIR)/%.lo: src/%.c
+	@echo " CC $@"
+	@mkdir -p $(dir $@)
+	@libtool --silent --mode=compile --tag=CC $(CC) $(CFLAGS) -o $@ -c $<
+
 $(OBJDIR)/%.o: tools/%.c
 	@echo " CC $@"
 	@mkdir -p $(dir $@)
@@ -162,6 +171,16 @@
 	@/sbin/ldconfig -n $(LIBDIR)
 	@ln -fs liboggkate.so.$(SONAME_MAJOR) lib/liboggkate.so
 
+$(LIBDIR)/libkate.la: $(OBJS_LIBTOOL)
+	@echo " LD $@"
+	@mkdir -p $(dir $@)
+	@libtool --silent --mode=link --tag=CC $(CC) -rpath $(PREFIX)/lib -version-info $(SONAME_MAJOR) -no-undefined -o $@ $^
+
+$(LIBDIR)/liboggkate.la: $(LIBOGGKATE_OBJS_LIBTOOL) $(LIBDIR)/libkate.la
+	@echo " LD $@"
+	@mkdir -p $(dir $@)
+	@libtool --silent --mode=link --tag=CC $(CC) -rpath $(PREFIX)/lib -version-info $(SONAME_MAJOR) -no-undefined -o $@ $^
+
 .PHONY: clean
 clean:
 	rm -f $(OBJS_STATIC) $(OBJS_STATIC:.o=.d)
@@ -196,6 +215,21 @@
            awk -v px="$(PREFIX)" '/^prefix=/ {print "prefix="px; next} {print}' \
            > $(PREFIX)/lib/pkgconfig/oggkate.pc
 
+.PHONY: install-libtool
+install-libtool: libtoollib
+	mkdir -p $(DESTDIR)$(PREFIX)/include/kate
+	install -m644 include/kate/kate.h include/kate/oggkate.h $(DESTDIR)$(PREFIX)/include/kate/
+	mkdir -p $(DESTDIR)$(PREFIX)/lib
+	libtool --silent --mode=install install $(LIBDIR)/libkate.la $(DESTDIR)$(PREFIX)/lib/
+	libtool --silent --mode=install install $(LIBDIR)/liboggkate.la $(DESTDIR)$(PREFIX)/lib/
+	mkdir -p $(DESTDIR)$(PREFIX)/lib/pkgconfig
+	cat misc/pkgconfig/kate.pc\
+           | awk -v px="$(PREFIX)" '/^prefix=/ {print "prefix="px; next} {print}' \
+           > $(DESTDIR)$(PREFIX)/lib/pkgconfig/kate.pc
+	cat misc/pkgconfig/oggkate.pc | \
+           awk -v px="$(PREFIX)" '/^prefix=/ {print "prefix="px; next} {print}' \
+           > $(DESTDIR)$(PREFIX)/lib/pkgconfig/oggkate.pc
+
 .PHONY: uninstall
 uninstall:
 	-rm -f $(PREFIX)/lib/libkate.a $(PREFIX)/lib/liboggkate.a
@@ -300,7 +334,6 @@
 	  cmp $(tmp_kate1) $(tmp_kate2) && \
 	) rm -f $(tmp_ogg1) $(tmp_ogg2) $(tmp_kate1) $(tmp_kate2)
 
-tools/encoder tools/decoder: $(LIBDIR)/liboggkate.a $(LIBDIR)/libkate.a
 
 ifneq '$(findstring clean,$(MAKECMDGOALS))' 'clean'
 -include obj/*.d obj/*/*.d
